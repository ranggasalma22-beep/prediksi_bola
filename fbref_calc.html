<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>FBref Calculator (Extended)</title>
<style>
body{background:#0f172a;color:#e5e7eb;font-family:Arial,Helvetica,sans-serif;max-width:560px;margin:auto;padding:16px}
h1{font-size:18px;margin-bottom:12px}
.box{background:#020617;padding:14px;border-radius:10px;margin-bottom:14px}
label{font-size:13px;display:block;margin-top:8px}
textarea,input{width:100%;background:#020617;color:#e5e7eb;border:1px solid #334155;border-radius:6px;padding:8px;margin-top:4px}
button{width:100%;padding:12px;background:#16a34a;color:#022c22;border:none;border-radius:10px;font-size:15px;font-weight:bold;cursor:pointer;margin-top:10px}
.result{margin-top:10px;background:#020617;padding:10px;border-radius:8px;font-size:14px}
.note{margin-top:10px;font-size:12px;opacity:.8}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
</style>
</head>

<body>

<h1>⚽ FBref Calculator (Extended Manual)</h1>

<!-- ================= EXISTING CALCULATOR ================= -->

<div class="box">
<h3>Home Team — xG / Shots / SOT</h3>
<label>xG per match (comma separated)</label>
<textarea id="hxglist"></textarea>

<label>Shots per match</label>
<textarea id="hshots"></textarea>

<label>SOT per match</label>
<textarea id="hsot"></textarea>

<div class="result" id="hresult">Home: -</div>
</div>

<div class="box">
<h3>Away Team — xG / Shots / SOT</h3>
<label>xG per match (comma separated)</label>
<textarea id="axglist"></textarea>

<label>Shots per match</label>
<textarea id="ashots"></textarea>

<label>SOT per match</label>
<textarea id="asot"></textarea>

<div class="result" id="aresult">Away: -</div>
</div>

<button id="calcBtn">CALCULATE xG / SHOTS / SOT</button>

<!-- ================= NEW MANUAL STATS CALCULATOR ================= -->

<div class="box">
<h3>Manual Match Stats (5 Matches)</h3>
<small>Untuk menghitung GF / GA / Clean Sheet Rate / Defensive Errors</small>

<div class="grid">

<div>
<h4>HOME</h4>
<label>Goals Scored (5 match, comma separated)</label>
<textarea id="gfH_list"></textarea>

<label>Goals Conceded (5 match, comma separated)</label>
<textarea id="gaH_list"></textarea>

<label>Defensive Errors (total)</label>
<input id="errH" type="number">

<div class="result" id="hstat">Home Stats: -</div>
</div>

<div>
<h4>AWAY</h4>
<label>Goals Scored (5 match, comma separated)</label>
<textarea id="gfA_list"></textarea>

<label>Goals Conceded (5 match, comma separated)</label>
<textarea id="gaA_list"></textarea>

<label>Defensive Errors (total)</label>
<input id="errA" type="number">

<div class="result" id="astat">Away Stats: -</div>
</div>

</div>

<button onclick="calcManual()">CALCULATE GF / GA / CS</button>
</div>

<div class="note">
• Tidak ada default value<br>
• Calculator ini TIDAK mempengaruhi engine utama<br>
• Output siap dipindahkan ke engine analisis
</div>

<script>
function clamp(v,min,max){return Math.max(min,Math.min(max,v))}
function parseList(t){return t.split(',').map(x=>Number(x.trim())).filter(x=>!isNaN(x))}
function avg(a){return a.reduce((s,v)=>s+v,0)/a.length}

function calc(label,xgList,shotsList,sotList){
  if(xgList.length<5||xgList.length>10)return label+": use 5–10 matches"
  let xg=clamp(avg(xgList),0.7,2.1)
  let shots=shotsList.length?avg(shotsList):null
  let sot=sotList.length?avg(sotList):null
  let out=label+": xG "+xg.toFixed(2)
  if(shots)out+=" | Shots "+shots.toFixed(1)
  if(sot)out+=" | SOT "+sot.toFixed(1)
  if(shots&&sot){
    let r=sot/shots
    if(r<0.28||r>0.42)out+=" ⚠️ High Volatility"
  }
  return out
}

document.getElementById("calcBtn").onclick=function(){
  document.getElementById("hresult").innerText=calc(
    "Home",
    parseList(hxglist.value),
    parseList(hshots.value),
    parseList(hsot.value)
  )
  document.getElementById("aresult").innerText=calc(
    "Away",
    parseList(axglist.value),
    parseList(ashots.value),
    parseList(asot.value)
  )
}

function calcManual(){
  const gfH=parseList(gfH_list.value)
  const gaH=parseList(gaH_list.value)
  const gfA=parseList(gfA_list.value)
  const gaA=parseList(gaA_list.value)

  if(gfH.length!==5||gaH.length!==5||gfA.length!==5||gaA.length!==5){
    alert("Isi TEPAT 5 match untuk semua list gol")
    return
  }

  const sum=a=>a.reduce((s,v)=>s+v,0)
  const cs=a=>a.filter(v=>v===0).length/5

  hstat.innerText=
    "GF "+sum(gfH)+
    " | GA "+sum(gaH)+
    " | CS "+cs(gaH).toFixed(2)+
    " | Errors "+(errH.value||0)

  astat.innerText=
    "GF "+sum(gfA)+
    " | GA "+sum(gaA)+
    " | CS "+cs(gaA).toFixed(2)+
    " | Errors "+(errA.value||0)
}
</script>

</body>
  </html>

<!DOCTYPE html><html lang="id">
<head>
<meta charset="UTF-8">
<title>Neutral Football Analysis Engine – Stable</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{background:#05070b;color:#eaeaea;font-family:Arial;padding:16px}
h1,h3{color:#66fcf1;margin-top:0}
.section{background:#0f1420;border:1px solid #333;border-radius:8px;padding:14px;margin-bottom:16px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
label{display:block;margin-top:8px;font-size:13px;color:#9ff}
textarea,select{width:100%;padding:8px;background:#1a2030;border:1px solid #555;color:#fff;border-radius:6px;font-family:monospace;font-size:13px}
textarea{height:64px}
button{width:100%;padding:14px;background:#66fcf1;border:none;border-radius:8px;font-weight:bold;font-size:15px;cursor:pointer}
#out{height:360px;background:#020304;color:#00ff88}
@media(max-width:700px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<h1>Neutral Football Analysis Engine</h1><div class="section">
<h3>Match Info</h3>
<label>Match Type</label>
<select id="matchType">
<option value="league">League</option>
<option value="big">Big Match</option>
<option value="cup">Cup</option>
<option value="knockout">Knockout</option>
<option value="final">Final</option>
</select>
<label>OU Line</label>
<select id="ouLine">
<option value="2">2.0</option>
<option value="2.25">2.25</option>
<option value="2.5" selected>2.5</option>
<option value="2.75">2.75</option>
<option value="3">3.0</option>
</select>
</div><div class="section">
<h3>RAW DATA INPUT – HOME vs AWAY (Last 5 Matches)</h3>
<div class="grid">
<div>
<h3>HOME</h3>
<label>xG</label><textarea id="xgH"></textarea>
<label>xGA</label><textarea id="xgaH"></textarea>
<label>Goals For</label><textarea id="gfH"></textarea>
<label>Goals Against</label><textarea id="gaH"></textarea>
<label>Shots on Target</label><textarea id="sotH"></textarea>
<label>SCA</label><textarea id="scaH"></textarea>
</div>
<div>
<h3>AWAY</h3>
<label>xG</label><textarea id="xgA"></textarea>
<label>xGA</label><textarea id="xgaA"></textarea>
<label>Goals For</label><textarea id="gfA"></textarea>
<label>Goals Against</label><textarea id="gaA"></textarea>
<label>Shots on Target</label><textarea id="sotA"></textarea>
<label>SCA</label><textarea id="scaA"></textarea>
</div>
</div>
</div><button onclick="run()">ANALYZE</button>

<div class="section">
<h3>OUTPUT</h3>
<textarea id="out" readonly></textarea>
</div><script>
// ================= CORE UTIL =================
const CONFIDENCE_MIN = 58;
const $ = id => document.getElementById(id);
const clamp = (v,a,b)=>Math.max(a,Math.min(b,v));
const parseArr = s => s ? s.split(',').map(x=>+x.trim()).filter(x=>isFinite(x)) : [];
const avg = a => a.length ? a.reduce((x,y)=>x+y,0)/a.length : null;

function poisson(l,k){let f=1;for(let i=2;i<=k;i++)f*=i;return Math.exp(-l)*Math.pow(l,k)/f;}

function detectLowBlock(sotAvg,xgAvg,matchType){
  if(sotAvg==null||xgAvg==null) return false;
  if(matchType==='final'||matchType==='knockout') return sotAvg<4;
  return sotAvg<3 && xgAvg>0.8;
}

function run(){
  const out = $('out');
  out.value='';
  try{
    const home={xg:parseArr(xgH.value),xga:parseArr(xgaH.value),gf:parseArr(gfH.value),ga:parseArr(gaH.value),sot:parseArr(sotH.value),sca:parseArr(scaH.value)};
    const away={xg:parseArr(xgA.value),xga:parseArr(xgaA.value),gf:parseArr(gfA.value),ga:parseArr(gaA.value),sot:parseArr(sotA.value),sca:parseArr(scaA.value)};

    if(home.xg.length<3||away.xg.length<3||home.xga.length<3||away.xga.length<3){
      out.value='Minimal 3 data xG & xGA HOME dan AWAY'; return;
    }

    const hxg=avg(home.xg), axg=avg(away.xg);
    const hSOT=avg(home.sot), aSOT=avg(away.sot);

    let lamH=hxg, lamA=axg;
    if(hSOT) lamH*=clamp(1+(hSOT/(hxg*2.5)-1)*0.12,0.9,1.12);
    if(aSOT) lamA*=clamp(1+(aSOT/(axg*2.5)-1)*0.12,0.9,1.12);
    lamH=clamp(lamH,0.2,4); lamA=clamp(lamA,0.2,4);

    let over25=0; const dist=[];
    for(let h=0;h<=5;h++)for(let a=0;a<=5;a++){
      const p=poisson(lamH,h)*poisson(lamA,a);
      dist.push({s:`${h}-${a}`,p}); if(h+a>2) over25+=p;
    }
    dist.sort((x,y)=>y.p-x.p);

    const ouLine=parseFloat($('ouLine').value);
    let overProb=0;
    for(const d of dist){
      const [h,a]=d.s.split('-').map(Number);
      const total=h+a;
      if(ouLine===2) overProb+= total>=3?d.p:0;
      else if(ouLine===2.25) overProb+= total>=3?d.p:(total===2?0.5*d.p:0);
      else if(ouLine===2.5) overProb+= total>=3?d.p:0;
      else if(ouLine===2.75) overProb+= total>=4?d.p:(total===3?0.5*d.p:0);
      else if(ouLine===3) overProb+= total>=4?d.p:0;
    }
    const underProb=1-overProb;
    const confidence=Math.round(Math.max(overProb,underProb)*100);(Math.max(over25,under25)*100);
    if(confidence<CONFIDENCE_MIN){
      out.value=`CONFIDENCE : ${confidence}%\nSTATUS     : NO BET`;
      return;
    }

    const lowBlock = detectLowBlock(hSOT,hxg,$('matchType').value) || detectLowBlock(aSOT,axg,$('matchType').value);

    let scaNote='';
    const hSCA=avg(home.sca), aSCA=avg(away.sca);
    if(hSCA&&aSCA){
      if(hSCA>=15&&aSCA>=15&&(hSOT+aSOT)>=9) scaNote='SCA : Tekanan sejalan dengan SoT\n';
      else if(hSCA>=15&&aSCA>=15&&(hSOT+aSOT)<9) scaNote='SCA : Fake pressure (hati-hati)\n';
    }

    out.value=
      `HOME λ : ${lamH.toFixed(2)}\n`+
      `AWAY λ : ${lamA.toFixed(2)}\n\n`+
      `Most Likely Score : ${dist[0].s}\n`+
      `Over ${ouLine} Prob     : ${(over25*100).toFixed(1)}%\n`+
      `Under ${ouLine} Prob    : ${(under25*100).toFixed(1)}%\n`+
      `Confidence        : ${confidence}%\n`+
      (lowBlock?`Low Block        : Detected\n`:'')+
      scaNote;
  }catch(e){ out.value='ERROR: '+e.message; }
}
</script></body>
                                      </html>
